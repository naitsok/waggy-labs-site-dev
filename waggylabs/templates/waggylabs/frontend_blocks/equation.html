{% load wagtailmarkdown %}
{% load waggylabs_filters %}

{% if sidebar %}
<div id="sidebar-bl-{{ id }}">
    <div class="waggylabs-sidebar-button-container">
        <div class="overflow-hidden">
            <p>{{ value.equation }}</p>
        </div>
        <button type="button" class="{{ visual_settings.preview_buttons_style }} waggylabs-sidebar-button" data-bs-toggle="modal" data-bs-target="#modal-{{ id }}">
            {% if visual_settings.preview_buttons_icon|is_icon %}<i class="{{  visual_settings.preview_buttons_icon|icon_class }}{% if  visual_settings.preview_buttons_text %} me-1{% endif %}"></i>{% endif %}{{ visual_settings.preview_buttons_text }}
        </button>
    </div>
    {% if value.caption %}
    <div class="figure-caption mb-3">
        {% if page.equation_caption_label %}<p class="me-2 waggylabs-entity-label">{{ page.equation_caption_label }}</p>{% endif %}{{ value.caption|markdown|safe }}
    </div>
    {% endif %}
</div>
{% elif modal %}
<div class="modal fade" id="modal-{{ id }}" tabindex="-1" aria-labelledby="modal-label-{{ id }}" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
            <h1 class="modal-title fs-5" id="modal-label-{{ id }}">Modal title</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="modal-bl-{{ id }}">
                    <p>{{ value.equation }}</p>
                    {% if value.caption %}
                    <div class="figure-caption">
                        {{ value.caption|markdown|safe }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="waggylabs-label-equation" {% if value.label %}id="{{ value.label }}"{% endif %} sidebar="bl-{{ id }}">
    <p>{{ value.equation }}</p>
    {% if value.caption %}
    <div class="figure-caption d-none">
        {% if page.equation_caption_label %}<p class="me-2 waggylabs-entity-label">{{ page.equation_caption_label }}</p>{% endif %}{{ value.caption|markdown|safe }}
    </div>
    {% endif %}
</div>
{% endif %}

