{% load wagtailcore_tags %}
{% load wagtailembeds_tags %}
{% load wagtailmarkdown %}
{% load waggylabs_filters %}

{% if sidebar %}
<figure class="w-100 mb-3" id="sidebar-bl-{{ id }}">
    <div class="waggylabs-sidebar-button-container">
        <div class="border rounded">
            <div class="ratio ratio-16x9">
                {% embed value.embed.url %}
            </div>
        </div>
        <button type="button" class="{{ visual_settings.preview_buttons_style }} waggylabs-sidebar-button" {% comment %} data-toggle="modal" data-target="#modal-{{ id }}"{% endcomment %}>
            {% if visual_settings.preview_buttons_icon|is_icon %}<i class="{{  visual_settings.preview_buttons_icon|icon_class }}{% if  visual_settings.preview_buttons_text %} me-1{% endif %}"></i>{% endif %}{{ visual_settings.preview_buttons_text }}
        </button>
    </div>
    {% if value.caption %}
        <figcaption class="figure-caption">
            {% if page.embed_caption_label %}<p class="me-2 waggylabs-entity-label">{{ page.embed_caption_label }}</p>{% endif %}{{ value.caption|markdown|safe }}
        </figcaption>
    {% endif %}
</figure>
{% else %}
<figure class="mb-3 waggylabs-label-embed" {% if value.label %}id="{{ value.label }}"{% endif %} sidebar="bl-{{ id }}">
    <div class="border rounded">
        <div class="ratio ratio-16x9">
            {% embed value.embed.url %}
        </div>
    </div>
    {% if value.caption %}
        <figcaption class="figure-caption">
            {% if page.embed_caption_label %}<p class="me-2 waggylabs-entity-label">{{ page.embed_caption_label }}</p>{% endif %}{{ value.caption|markdown|safe }}
        </figcaption>
    {% endif %}
</figure>
{% endif %}