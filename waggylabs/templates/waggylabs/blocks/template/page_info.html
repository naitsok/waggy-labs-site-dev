{% load wagtailcore_tags %}
{% load wagtailroutablepage_tags %}
{% load waggylabs_filters %}

<div class="card {{ value.style }} {{ value.alignment }} mb-3">
    {% if value.header or value.header_icon %}
    <div class="card-header">
        {% if value.header_icon_location == 'end' %}
        <p class="{{ value.header_style }}">
            {{ value.header }}
            {% if value.header_icon|is_icon %}<i class="{{ value.header_icon|icon_class }}{% if value.header %} ms-1{% endif %}"></i>{% endif %}
        </p>
        {% else %}
        <p class="{{ value.header_style }}">
            {% if value.header_icon|is_icon %}<i class="{{ value.header_icon|icon_class }}{% if value.header %} me-1{% endif %}"></i>{% endif %}
            {{ value.header }}
        </p>
        {% endif %}
    </div>
    {% endif %}
    <div class="card-body">
        <dl class="row">
            {% if value.show_user %}
            {% if value.show_header %}
                <dt class="col-sm-3">
                    <a href="#" class="{{ value.header_style }}">{{ value.user_header }}</a>
                </dt>
            {% endif %}
            {# TODO: add correct link after developing #}
            <dd class="{{ value.dd_width }}">
                <a href="#" class="{{ value.data_style }}">
                    {% if value.show_avatar and value.avatar_location != 'end' %}<span class="me-1">{{ value.avatar }}</span>{% endif %}
                    {% if value.full_name %}{{ value.full_name }}{% else %}{{ value.username }}{% endif %}
                    {% if value.show_avatar and value.avatar_location == 'end' %}<span class="ms-1">{{ value.avatar }}</span>{% endif %}
                </a>
            </dd>
            {% endif %}
            {% if value.email_header %}
            {% if value.show_header %}
                <dt class="col-sm-3">
                    <a href="#" class="{{ value.header_style }}">{{ value.email_header }}</a>
                </dt>
            {% endif %}
            <dd class="{{ value.dd_width }}"><a href="mailto:{{ value.email }}" class="{{ value.data_style }}">{{ value.email }}</a></dd>
            {% endif %}
            {% if value.show_first_published_at %}
            {% if value.show_header %}
                <dt class="col-sm-3">
                    <a href="#" class="{{ value.header_style }}">{{ value.first_published_at_header }}</a>
                </dt>
            {% endif %}
            <dd class="{{ value.dd_width }}">
                <div class="{{ value.header_style }}">
                    {% if value.datatime_style == 'timesince' %}
                    {{ value.first_published_at|timesince }} {{ value.timesince_text }}
                    {% else %}
                    {{ value.first_published_at|date:'j E, Y' }} {% if value.datatime_style == 'datetime' %}{{ value.first_published_at|time:value.time_format }}{% endif %}
                    {% endif %}
                </div>
            </dd>
            {% endif %}
            {% if value.show_last_published_at %}
            {% if value.show_header %}
                <dt class="col-sm-3">
                    <a href="#" class="{{ value.header_style }}">{{ value.last_published_at_header }}</a>
                </dt>
            {% endif %}
            <dd class="{{ value.dd_width }}">
                <div class="{{ value.header_style }}">
                    {% if value.datatime_style == 'timesince' %} 
                    {{ value.last_published_at|timesince }} {{ value.timesince_text }}
                    {% else %}
                    {{ value.last_published_at|date:'j E, Y' }} {% if value.datatime_style == 'datetime' %}{{ value.last_published_at|time:value.time_format }}{% endif %}
                    {% endif %}
                </div>
            </dd>
            {% endif %}
        </dl>
    </div>
</div>